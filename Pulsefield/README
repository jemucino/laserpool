Code copied from Pulsefield project that is used here
